<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> concurve R Package | Less Likely </title>
<!-- favicons --><link rel="shortcut icon" type="image/x-icon" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-180x180.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Comparison to Bayesian Posterior Distributions">
<meta property="og:description" content="This vignette discusses how consonance distributions and Bayesian posterior distributions differ in interpretation but how they can also often converge. This is shown with several examples of how to calculate both distributions in a range of scenarios.">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/d/d4/Thomas_Bayes.gif,concurve R package hex logo">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116104766-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116104766-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand"><img src="https://res.cloudinary.com/less-likely/image/upload/v1575427534/Site/Logo.svg" id="package-logo" align="left" width="35"><a class="navbar-link" href="../index.html">concurve</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Examples in R</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival Modeling</a>
    </li>
    <li>
      <a href="../articles/meta-analysis.html">Meta-Analysis Examples</a>
    </li>
    <li>
      <a href="../articles/likelihood.html">Profile Likelihoods</a>
    </li>
    <li>
      <a href="../articles/bootstrap.html">Bootstrap and Consonance Functions</a>
    </li>
    <li>
      <a href="../articles/bayes.html">Comparison to Bayesian Posteriors</a>
    </li>
    <li>
      <a href="../articles/stata.html">Using Stata</a>
    </li>
    <li>
      <a href="../articles/customizing.html">Customizing Plots</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/casestudies.html">Case Studies</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tools
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/svalues.html">S-value Calculator</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Updates</a>
    </li>
    <li>
      <a href="../articles/wishlist.html">Wish List</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zadrafi/concurve">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/dailyzad">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bayes_files/header-attrs-2.2/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Comparison to Bayesian Posterior Distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zadrafi/concurve/blob/master/vignettes/bayes.Rmd"><code>vignettes/bayes.Rmd</code></a></small>
      <div class="hidden name"><code>bayes.Rmd</code></div>

    </div>

    
    
<p>Unlike Bayesian posterior distributions, confidence/consonance functions do not have any distributional properties and also lack the interpretation that should be given to Bayesian posterior intervals. For example, a Bayesian 95% posterior interval has the proper interpretation of having a 95% probability of containing the true value.</p>
<p>This does not apply to 95% frequentist intervals, where the 95% refers to the long run coverage of these intervals containing the true parameter if the study were repeated over and over. Thus, either a 95% frequentist interval contains the true parameter or it does not. In the code below, we simulate some data where the true population parameter is 20 and we know this because we’re the deities of this world. A properly behaving statistical procedure with a set alpha of 0.05 will yield <em>at least</em> 95% intervals in the long run that will include this population parameter of 20. Those that do not are marked in red.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">sim</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">fake</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>((<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">20</span>)), (<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="fl">80</span>, <span class="fl">20</span>)))
  <span class="no">intervals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">fake</span>, <span class="kw">conf.level</span> <span class="kw">=</span> <span class="fl">.95</span>)$<span class="no">conf.int</span>[]
}

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1031</span>)

<span class="no">z</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">100</span>, <span class="fu">sim</span>(), <span class="kw">simplify</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">z</span>))
<span class="no">df</span>$<span class="no">studynumber</span> <span class="kw">&lt;-</span> (<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">z</span>))
<span class="no">intrvl.limit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lower.limit"</span>, <span class="st">"upper.limit"</span>, <span class="st">"studynumber"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">df</span>) <span class="kw">&lt;-</span> <span class="no">intrvl.limit</span>
<span class="no">df</span>$<span class="no">point</span> <span class="kw">&lt;-</span> ((<span class="no">df</span>$<span class="no">lower.limit</span> + <span class="no">df</span>$<span class="no">upper.limit</span>) / <span class="fl">2</span>)
<span class="no">df</span>$<span class="no">covered</span> <span class="kw">&lt;-</span> (<span class="no">df</span>$<span class="no">lower.limit</span> <span class="kw">&lt;=</span> <span class="fl">20</span> <span class="kw">&amp;</span> <span class="fl">20</span> <span class="kw">&lt;=</span> <span class="no">df</span>$<span class="no">upper.limit</span>)
<span class="no">df</span>$<span class="no">coverageprob</span> <span class="kw">&lt;-</span> ((<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">df</span>$<span class="no">covered</span>)[<span class="fl">2</span>]) / <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">df</span>) * <span class="fl">100</span>))

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)


<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">studynumber</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">point</span>, <span class="kw">ymin</span> <span class="kw">=</span> <span class="no">lower.limit</span>, <span class="kw">ymax</span> <span class="kw">=</span> <span class="no">upper.limit</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">covered</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">.40</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(
    <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Simulated 95% Intervals"</span>,
    <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Study Number"</span>,
    <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Estimate"</span>,
    <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Population Parameter is 20"</span>
  ) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() + <span class="co"># use a white background</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(
    <span class="kw">geom</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="fl">102</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">30</span>,
    <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Coverage (%) ="</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">2.5</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>
  ) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(
    <span class="kw">geom</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="fl">102</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">35</span>,
    <span class="kw">label</span> <span class="kw">=</span> <span class="no">df</span>$<span class="no">coverageprob</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">2.5</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>
  )</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>Although the code above demonstrates this, one of the best visualization tools to understand this long-run behavior is the D3.js visualization created by Kristoffer Magnusson, which <a href="https://rpsychologist.com/d3/CI/">can be viewed here</a>.</p>
<p>However, despite these differences in interpretation, Bayesian and frequentist intervals often end up converging, especially when there are large amounts of data. They also end up converging when a Bayesian posterior distribution is computed with a flat or weakly informative prior. However, there are several problems with using flat priors, such as giving equal weight to all values in the interval including implausible ones. These sorts of priors should generally be avoided. However, for the sake of this demonstration, we will be using flat priors.</p>
<p>Here, I demonstrate with a simple example how Bayesian posterior distributions and frequentist confidence functions end up converging in some scenarios. For these first few examples, I’ll be using the <code>rstanarm</code> package.<span class="citation"><sup><a href="#ref-Goodrich_Gabry_Ali_Brilleman_2020" role="doc-biblioref">1</a></sup></span></p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">concurve</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rstan</span>)
<span class="co">#&gt; Loading required package: StanHeaders</span>
<span class="co">#&gt; rstan (Version 2.19.3, GitRev: 2e1f913d3ca3)</span>
<span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span>
<span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span class="co">#&gt; rstan_options(auto_write = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rstanarm</span>)
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'lme4':</span>
<span class="co">#&gt;   method                          from</span>
<span class="co">#&gt;   cooks.distance.influence.merMod car </span>
<span class="co">#&gt;   influence.merMod                car </span>
<span class="co">#&gt;   dfbeta.influence.merMod         car </span>
<span class="co">#&gt;   dfbetas.influence.merMod        car</span>
<span class="co">#&gt; rstanarm (Version 2.19.3, packaged: 2020-02-11 05:16:41 UTC)</span>
<span class="co">#&gt; - Do not expect the default priors to remain the same in future rstanarm versions.</span>
<span class="co">#&gt; Thus, R scripts should specify priors explicitly, even if they are just the defaults.</span>
<span class="co">#&gt; - For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span class="co">#&gt; options(mc.cores = parallel::detectCores())</span>
<span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span>
<span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span>
<span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'rstanarm'</span>
<span class="co">#&gt; The following object is masked from 'package:rstan':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     loo</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cowplot</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ********************************************************</span>
<span class="co">#&gt; Note: As of version 1.0.0, cowplot does not change the</span>
<span class="co">#&gt;   default ggplot2 theme anymore. To recover the previous</span>
<span class="co">#&gt;   behavior, execute:</span>
<span class="co">#&gt;   theme_set(theme_cowplot())</span>
<span class="co">#&gt; ********************************************************</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">bayesplot</span>)
<span class="co">#&gt; This is bayesplot version 1.7.2</span>
<span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/bayesplot</span>
<span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span>
<span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span>
<span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scales</span>)</pre></body></html></div>
<p>We will simulate some data (two variables) from a normal distribution with a location parameter of 0 and scale parameter of 1 (something very simple) and then regress the second variables (GroupB) on the first using the base lm function. We will take the regression coefficient and construct a consonance function for it.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">GroupA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">50</span>)
<span class="no">GroupB</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">50</span>)
<span class="no">RandomData</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">GroupA</span>, <span class="no">GroupB</span>)
<span class="no">model_freq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">GroupA</span> ~ <span class="no">GroupB</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">RandomData</span>)</pre></body></html></div>
<p>Now we will do the same using Bayesian methods, but instead of specifying a prior, we will use a flat prior to show the convergence of the posterior with the consonance function.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/rstan/man/rstan_options.html">rstan_options</a></span>(<span class="kw">auto_write</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="co"># Using flat prior</span>
<span class="no">model_bayes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_lm.html">stan_lm</a></span>(<span class="no">GroupA</span> ~ <span class="no">GroupB</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">RandomData</span>, <span class="kw">prior</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">5000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>
)</pre></body></html></div>
<p>Now that we’ve fit the models, we can graph the functions.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">randomframe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_gen.html">curve_gen</a></span>(<span class="no">model_freq</span>, <span class="st">"GroupB"</span>, <span class="kw">steps</span> <span class="kw">=</span> <span class="fl">10000</span>)

(<span class="no">function1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"c"</span>, <span class="no">randomframe</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">nullvalue</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">
<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"teal"</span>)

<span class="no">function2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="no">model_bayes</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"GroupB"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Posterior Distribution"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Function Displays the Full Posterior Distribution"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Range of Values"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Posterior Probability"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.30</span>, <span class="fl">0.60</span>, <span class="fl">0.90</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.10</span>, <span class="fl">2.40</span>, <span class="fl">2.70</span>, <span class="fl">3.0</span>))
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>


(<span class="no">breaks1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.30</span>, <span class="fl">0.60</span>, <span class="fl">0.90</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.10</span>, <span class="fl">2.40</span>, <span class="fl">2.70</span>, <span class="fl">3.0</span>))
<span class="co">#&gt;  [1] 0.0 0.3 0.6 0.9 1.2 1.5 1.8 2.1 2.4 2.7 3.0</span>

(<span class="no">adjustment</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {
  <span class="no">x</span> / <span class="fl">3</span>
})
<span class="co">#&gt; function(x) {</span>
<span class="co">#&gt;   x / 3</span>
<span class="co">#&gt; }</span>

(<span class="no">labels</span> <span class="kw">&lt;-</span> <span class="fu">adjustment</span>(<span class="no">breaks1</span>))
<span class="co">#&gt;  [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0</span>

<span class="no">breaks</span> <span class="kw">&lt;-</span> <span class="no">labels</span>
<span class="no">labels1</span> <span class="kw">&lt;-</span> <span class="no">labels</span>

(<span class="no">function3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="no">model_bayes</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"GroupB"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Posterior Distribution"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Function Displays the Full Posterior Distribution"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Range of Values"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Posterior Probability"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/breaks_pretty.html">pretty_breaks</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">10</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html">waiver</a></span>(), <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html">waiver</a></span>(), <span class="kw">n.breaks</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">3.25</span>)) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_text</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_ticks</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(<span class="st">"segment"</span>,
    <span class="kw">x</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="fl">3</span>,
    <span class="kw">color</span> <span class="kw">=</span> <span class="st">"#990000"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">.75</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">3</span>
  ))
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span></pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>I made some adjustments above to the bayesplot code so that we could more easily compare the consonance distribution to the posterior distribution. We will be using plot_grid() from cowplot to achieve this.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="no">function1</span>, <span class="no">function3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">align</span> <span class="kw">=</span> <span class="st">"v"</span>)</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>As you can see, the results end up being very similar. You can likely get very similar results with weakly informative priors normal(0, 100) or with much larger datasets, where the likelihood will end up swamping the prior, though this isn’t always the case.</p>
<p>Here’s another example, but this time the variables we simulate have different location parameters.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="no">GroupA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="no">GroupB</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">500</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="no">RandomData</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">GroupA</span>, <span class="no">GroupB</span>)
<span class="no">model_freq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">GroupA</span> ~ <span class="no">GroupB</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">RandomData</span>)</pre></body></html></div>
<div class="sourceCode" id="cb9"><html><body><pre class="r">
<span class="co"># Using flat prior</span>
<span class="no">model_bayes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_lm.html">stan_lm</a></span>(<span class="no">GroupA</span> ~ <span class="no">GroupB</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">RandomData</span>, <span class="kw">prior</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">5000</span>, <span class="kw">warmup</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>
)</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
<span class="no">randomframe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_gen.html">curve_gen</a></span>(<span class="no">model_freq</span>, <span class="st">"GroupB"</span>, <span class="kw">steps</span> <span class="kw">=</span> <span class="fl">10000</span>)

(<span class="no">function1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">"c"</span>, <span class="no">randomframe</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">nullvalue</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"teal"</span>)

<span class="no">function2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="no">model_bayes</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"GroupB"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Posterior Distribution"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Function Displays the Full Posterior Distribution"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Range of Values"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Posterior Probability"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.30</span>, <span class="fl">0.60</span>, <span class="fl">0.90</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.10</span>, <span class="fl">2.40</span>, <span class="fl">2.70</span>, <span class="fl">3.0</span>))
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>


(<span class="no">breaks1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.30</span>, <span class="fl">0.60</span>, <span class="fl">0.90</span>, <span class="fl">1.20</span>, <span class="fl">1.50</span>, <span class="fl">1.80</span>, <span class="fl">2.10</span>, <span class="fl">2.40</span>, <span class="fl">2.70</span>, <span class="fl">3.0</span>))
<span class="co">#&gt;  [1] 0.0 0.3 0.6 0.9 1.2 1.5 1.8 2.1 2.4 2.7 3.0</span>

(<span class="no">adjustment</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {
  <span class="no">x</span> / <span class="fl">3</span>
})
<span class="co">#&gt; function(x) {</span>
<span class="co">#&gt;   x / 3</span>
<span class="co">#&gt; }</span>

(<span class="no">labels</span> <span class="kw">&lt;-</span> <span class="fu">adjustment</span>(<span class="no">breaks1</span>))
<span class="co">#&gt;  [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0</span>

<span class="no">breaks</span> <span class="kw">&lt;-</span> <span class="no">labels</span>
<span class="no">labels1</span> <span class="kw">&lt;-</span> <span class="no">labels</span>

(<span class="no">function3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="no">model_bayes</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"GroupB"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Posterior Distribution"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Function Displays the Full Posterior Distribution"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Range of Values"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Posterior Probability"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/breaks_pretty.html">pretty_breaks</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">10</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html">waiver</a></span>(), <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html">waiver</a></span>(), <span class="kw">n.breaks</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">limits</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">9</span>)) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_text</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_ticks</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(<span class="st">"segment"</span>,
    <span class="kw">x</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">xend</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">yend</span> <span class="kw">=</span> <span class="fl">9</span>,
    <span class="kw">color</span> <span class="kw">=</span> <span class="st">"#990000"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">.75</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">3</span>
  ))
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span></pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="no">function1</span>, <span class="no">function3</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">align</span> <span class="kw">=</span> <span class="st">"v"</span>)</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Here’s another dataset, however, here we’re not generating random numbers.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">kidiq</span>)

<span class="co"># flat prior</span>

<span class="no">post1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_lm.html">stan_lm</a></span>(<span class="no">kid_score</span> ~ <span class="no">mom_hs</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">kidiq</span>, <span class="kw">prior</span> <span class="kw">=</span> <span class="kw">NULL</span>,
  <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">12345</span>
)</pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">post2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">kid_score</span> ~ <span class="no">mom_hs</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">kidiq</span>)

<span class="no">df3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_gen.html">curve_gen</a></span>(<span class="no">post2</span>, <span class="st">"mom_hs"</span>)

(<span class="no">function99</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="no">df3</span><span class="kw">[[</span><span class="fl">1</span>]]))</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">post1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Info:</span>
<span class="co">#&gt;  function:     stan_lm</span>
<span class="co">#&gt;  family:       gaussian [identity]</span>
<span class="co">#&gt;  formula:      kid_score ~ mom_hs</span>
<span class="co">#&gt;  algorithm:    sampling</span>
<span class="co">#&gt;  sample:       4000 (posterior sample size)</span>
<span class="co">#&gt;  priors:       see help('prior_summary')</span>
<span class="co">#&gt;  observations: 434</span>
<span class="co">#&gt;  predictors:   2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;                 mean   sd   10%   50%   90%</span>
<span class="co">#&gt; (Intercept)   77.4    2.0 74.8  77.4  80.1 </span>
<span class="co">#&gt; mom_hs        11.9    2.3  8.9  12.0  14.8 </span>
<span class="co">#&gt; sigma         19.9    0.7 19.0  19.8  20.7 </span>
<span class="co">#&gt; log-fit_ratio -0.2    0.0 -0.2  -0.2  -0.1 </span>
<span class="co">#&gt; R2             0.1    0.0  0.0   0.1   0.1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit Diagnostics:</span>
<span class="co">#&gt;            mean   sd   10%   50%   90%</span>
<span class="co">#&gt; mean_PPD 86.7    1.3 85.0  86.7  88.4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MCMC diagnostics</span>
<span class="co">#&gt;               mcse Rhat n_eff</span>
<span class="co">#&gt; (Intercept)   0.1  1.0  1250 </span>
<span class="co">#&gt; mom_hs        0.1  1.0  1144 </span>
<span class="co">#&gt; sigma         0.0  1.0  1987 </span>
<span class="co">#&gt; log-fit_ratio 0.0  1.0  1272 </span>
<span class="co">#&gt; R2            0.0  1.0  1100 </span>
<span class="co">#&gt; mean_PPD      0.0  1.0  3958 </span>
<span class="co">#&gt; log-posterior 0.0  1.0  1382 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span>

<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"teal"</span>)

(<span class="no">function101</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span>(<span class="no">post1</span>, <span class="kw">pars</span> <span class="kw">=</span> <span class="st">"mom_hs"</span>, <span class="kw">point_est</span> <span class="kw">=</span> <span class="st">"none"</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">prob_outer</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">area_method</span> <span class="kw">=</span> <span class="st">"equal height"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Posterior Distribution"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Function Displays the Full Posterior Distribution"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Range of Values"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Posterior Probability"</span>) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_text</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html">yaxis_ticks</a></span>(<span class="kw">on</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="kw pkg">cowplot</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="no">function99</span>, <span class="no">function101</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">align</span> <span class="kw">=</span> <span class="st">"v"</span>)</pre></body></html></div>
<p><img src="bayes_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Practically the same.</p>
<hr>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<hr>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>#&gt; R version 4.0.0 (2020-04-24)
#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)
#&gt; Running under: macOS Catalina 10.15.5
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
#&gt; 
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] scales_1.1.1         bayesplot_1.7.2      cowplot_1.0.0       
#&gt; [4] rstanarm_2.19.3      Rcpp_1.0.4.9         rstan_2.19.3        
#&gt; [7] StanHeaders_2.21.0-5 concurve_2.6.0       ggplot2_3.3.1       
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;   [1] minqa_1.2.4           colorspace_1.4-1      ggsignif_0.6.0       
#&gt;   [4] ellipsis_0.3.1        rio_0.5.16            ggridges_0.5.2       
#&gt;   [7] rsconnect_0.8.16      rprojroot_1.3-2       flextable_0.5.10     
#&gt;  [10] markdown_1.1          base64enc_0.1-3       fs_1.4.1             
#&gt;  [13] rstudioapi_0.11       ggpubr_0.3.0          farver_2.0.3         
#&gt;  [16] DT_0.13               fansi_0.4.1           xml2_1.3.2           
#&gt;  [19] codetools_0.2-16      splines_4.0.0         knitr_1.28           
#&gt;  [22] shinythemes_1.1.2     nloptr_1.2.2.1        broom_0.5.6          
#&gt;  [25] km.ci_0.5-2           bcaboot_0.2-1         shiny_1.4.0.2        
#&gt;  [28] compiler_4.0.0        backports_1.1.7       fastmap_1.0.1        
#&gt;  [31] assertthat_0.2.1      Matrix_1.2-18         cli_2.0.2            
#&gt;  [34] later_1.1.0.1         htmltools_0.4.0       prettyunits_1.1.1    
#&gt;  [37] tools_4.0.0           igraph_1.2.5          gtable_0.3.0         
#&gt;  [40] glue_1.4.1            reshape2_1.4.4        dplyr_1.0.0          
#&gt;  [43] carData_3.0-4         cellranger_1.1.0      pkgdown_1.5.1        
#&gt;  [46] vctrs_0.3.1           nlme_3.1-148          crosstalk_1.1.0.1    
#&gt;  [49] xfun_0.14             stringr_1.4.0         ps_1.3.3             
#&gt;  [52] lme4_1.1-23           openxlsx_4.1.5        miniUI_0.1.1.1       
#&gt;  [55] mime_0.9              lifecycle_0.2.0       gtools_3.8.2         
#&gt;  [58] statmod_1.4.34        rstatix_0.5.0         MASS_7.3-51.6        
#&gt;  [61] zoo_1.8-8             colourpicker_1.0      promises_1.1.1       
#&gt;  [64] hms_0.5.3             ProfileLikelihood_1.1 parallel_4.0.0       
#&gt;  [67] inline_0.3.15         shinystan_2.5.0       metafor_2.4-0        
#&gt;  [70] yaml_2.2.1            curl_4.3              memoise_1.1.0        
#&gt;  [73] gridExtra_2.3         KMsurv_0.1-5          gdtools_0.2.2        
#&gt;  [76] loo_2.2.0             stringi_1.4.6         dygraphs_1.1.1.6     
#&gt;  [79] desc_1.2.0            boot_1.3-25           pkgbuild_1.0.8       
#&gt;  [82] zip_2.0.4             rlang_0.4.6           pkgconfig_2.0.3      
#&gt;  [85] systemfonts_0.2.2     matrixStats_0.56.0    evaluate_0.14        
#&gt;  [88] lattice_0.20-41       purrr_0.3.4           rstantools_2.1.0     
#&gt;  [91] htmlwidgets_1.5.1     labeling_0.3          tidyselect_1.1.0     
#&gt;  [94] processx_3.4.2        plyr_1.8.6            magrittr_1.5         
#&gt;  [97] R6_2.4.1              generics_0.0.2        pillar_1.4.4         
#&gt; [100] haven_2.3.1           foreign_0.8-80        withr_2.2.0          
#&gt; [103] xts_0.12-0            survival_3.1-12       abind_1.4-5          
#&gt; [106] tibble_3.0.1          crayon_1.3.4          car_3.0-8            
#&gt; [109] survMisc_0.5.5        uuid_0.1-4            rmarkdown_2.2        
#&gt; [112] officer_0.3.11        grid_4.0.0            readxl_1.3.1         
#&gt; [115] data.table_1.12.8     callr_3.4.3           threejs_0.3.3        
#&gt; [118] forcats_0.5.0         digest_0.6.25         pbmcapply_1.5.0      
#&gt; [121] xtable_1.8-4          tidyr_1.1.0           httpuv_1.5.4         
#&gt; [124] RcppParallel_5.0.1    stats4_4.0.0          munsell_0.5.0        
#&gt; [127] survminer_0.4.7       shinyjs_1.1</code></pre>
<div id="refs" class="references">
<div id="ref-Goodrich_Gabry_Ali_Brilleman_2020">
<p>1. Goodrich B, Gabry J, Ali I, Brilleman S. <em>Rstanarm: Bayesian Applied Regression Modeling via Stan.</em>; 2020. <a href="https://mc-stan.org/rstanarm">https://mc-stan.org/rstanarm</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://lesslikely.com/">Zad Rafi</a>, <a href="https://www.researchgate.net/profile/Andrew_Vigotsky">Andrew D. Vigotsky</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '328a30be91979e947c28ffd52f604eda',
    indexName: 'lesslikely-concurve',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
