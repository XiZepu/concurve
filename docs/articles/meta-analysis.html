<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> concurve R Package | Less Likely </title>
<!-- favicons --><link rel="shortcut icon" type="image/x-icon" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-180x180.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://github.com/zadrafi/concurve/raw/master/pkgdown/favicon/apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Meta-Analysis Examples">
<meta property="og:description" content="This guide walks through how to construct consonance functions from meta-analysis data using the metafor R package. Both simple and complex data structures are examined.">
<meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/f/f0/Generic_forest_plot.png,concurve R package hex logo">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116104766-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116104766-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand"><img src="https://data.lesslikely.com/concurve/reference/figures/logo.svg" id="package-logo" align="left" width="35"><a class="navbar-link" href="../index.html">concurve</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Examples in R</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival Modeling</a>
    </li>
    <li>
      <a href="../articles/meta-analysis.html">Meta-Analysis Examples</a>
    </li>
    <li>
      <a href="../articles/likelihood.html">Profile Likelihoods</a>
    </li>
    <li>
      <a href="../articles/bootstrap.html">Bootstrap and Consonance Functions</a>
    </li>
    <li>
      <a href="../articles/bayes.html">Comparison to Bayesian Posteriors</a>
    </li>
    <li>
      <a href="../articles/variancecomponents.html">Estimating Variance Components</a>
    </li>
    <li>
      <a href="../articles/stata.html">Using Stata</a>
    </li>
    <li>
      <a href="../articles/customizing.html">Customizing Plots</a>
    </li>
    <li>
      <a href="../articles/tables.html">Generating Tables</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/casestudies.html">Case Studies</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tools
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/svalues.html">S-value Calculator</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Updates</a>
    </li>
    <li>
      <a href="../articles/wishlist.html">Wish List</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zadrafi/concurve">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/dailyzad">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="meta-analysis_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Meta-Analysis Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zadrafi/concurve/blob/master/vignettes/meta-analysis.Rmd"><code>vignettes/meta-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>meta-analysis.Rmd</code></div>

    </div>

    
    
<div id="simple-data-structures" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-data-structures" class="anchor"></a>Simple Data Structures</h1>
<p>Here, weâ€™ll use an example dataset taken from the <a href="http://www.metafor-project.org/doku.php/analyses:normand1999"><code>metafor</code></a> website, which also comes preloaded with the <code>metafor</code> package.<span class="citation"><sup><a href="#ref-Viechtbauer_2010" role="doc-biblioref">1</a></sup></span></p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">metafor</span>)
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; Loading 'metafor' package (version 2.4-0). For an overview </span>
<span class="co">#&gt; and introduction to the package please type: help(metafor).</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">concurve</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="no">dat.hine1989</span>
<span class="co">#&gt;   study         source n1i n2i ai ci</span>
<span class="co">#&gt; 1     1  Chopra et al.  39  43  2  1</span>
<span class="co">#&gt; 2     2       Mogensen  44  44  4  4</span>
<span class="co">#&gt; 3     3    Pitt et al. 107 110  6  4</span>
<span class="co">#&gt; 4     4   Darby et al. 103 100  7  5</span>
<span class="co">#&gt; 5     5 Bennett et al. 110 106  7  3</span>
<span class="co">#&gt; 6     6 O'Brien et al. 154 146 11  4</span></pre></body></html></div>
<p>I will quote Wolfgang here, since he explains it best,</p>
<blockquote>
<p>"As described under help(dat.hine1989), variables <strong>n1i</strong> and <strong>n2i</strong> are the number of patients in the lidocaine and control group, respectively, and <strong>ai</strong> and <strong>ci</strong> are the corresponding number of deaths in the two groups. Since these are 2Ã—2 table data, a variety of different outcome measures could be used for the meta-analysis, including the risk difference, the risk ratio (relative risk), and the odds ratio (see Table III). Normand (1999) uses risk differences for the meta-analysis, so we will proceed accordingly. We can calculate the risk differences and corresponding sampling variances with:</p>
</blockquote>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/escalc.html">escalc</a></span>(<span class="kw">measure</span> <span class="kw">=</span> <span class="st">"RD"</span>, <span class="kw">n1i</span> <span class="kw">=</span> <span class="no">n1i</span>, <span class="kw">n2i</span> <span class="kw">=</span> <span class="no">n2i</span>, <span class="kw">ai</span> <span class="kw">=</span> <span class="no">ai</span>, <span class="kw">ci</span> <span class="kw">=</span> <span class="no">ci</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat.hine1989</span>)
<span class="no">dat</span>
<span class="co">#&gt;   study         source n1i n2i ai ci     yi     vi </span>
<span class="co">#&gt; 1     1  Chopra et al.  39  43  2  1 0.0280 0.0018 </span>
<span class="co">#&gt; 2     2       Mogensen  44  44  4  4 0.0000 0.0038 </span>
<span class="co">#&gt; 3     3    Pitt et al. 107 110  6  4 0.0197 0.0008 </span>
<span class="co">#&gt; 4     4   Darby et al. 103 100  7  5 0.0180 0.0011 </span>
<span class="co">#&gt; 5     5 Bennett et al. 110 106  7  3 0.0353 0.0008 </span>
<span class="co">#&gt; 6     6 O'Brien et al. 154 146 11  4 0.0440 0.0006</span></pre></body></html></div>
<blockquote>
<p>"Note that the <strong>yi</strong> values are the risk differences in terms of proportions. Since Normand (1999) provides the results in terms of percentages, we can make the results directly comparable by multiplying the risk differences by 100 (and the sampling variances by <span class="math inline">\(100^{2}\)</span>):</p>
</blockquote>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">dat</span>$<span class="no">yi</span> <span class="kw">&lt;-</span> <span class="no">dat</span>$<span class="no">yi</span> * <span class="fl">100</span>
<span class="no">dat</span>$<span class="no">vi</span> <span class="kw">&lt;-</span> <span class="no">dat</span>$<span class="no">vi</span> * <span class="fl">100</span>^<span class="fl">2</span></pre></body></html></div>
<p>We can fit a fixed-effects model with the following</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">fe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/rma.uni.html">rma</a></span>(<span class="no">yi</span>, <span class="no">vi</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"FE"</span>)</pre></body></html></div>
<p>Now that we have our metafor object, we can compute the consonance function using the <code><a href="../reference/curve_meta.html">curve_meta()</a></code> function.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">fecurve</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_meta.html">curve_meta</a></span>(<span class="no">fe</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">1L</span>)</pre></body></html></div>
<p>Now we can graph our function.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="no">fecurve</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">nullvalue</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="meta-analysis_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>We used a fixed-effects model here, but if we wanted to use a random-effects model, we could do so with the following, which will use a restricted maximum likelihood estimator for the random-effects model</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">re</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/rma.uni.html">rma</a></span>(<span class="no">yi</span>, <span class="no">vi</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"REML"</span>)</pre></body></html></div>
<p>And then we could use <code><a href="../reference/curve_meta.html">curve_meta()</a></code> to get the relevant list</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">recurve</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_meta.html">curve_meta</a></span>(<span class="no">re</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">1L</span>)</pre></body></html></div>
<p>Now we can plot our object.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="no">recurve</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">nullvalue</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="meta-analysis_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>We could also compare our two models to see how much consonance/overlap there is</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/curve_compare.html">curve_compare</a></span>(<span class="no">fecurve</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="no">recurve</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">plot</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; [1] "AUC = Area Under the Curve"</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; | AUC 1| AUC 2| Shared AUC| AUC Overlap (%)| Overlap:Non-Overlap AUC Ratio|</span>
<span class="co">#&gt; |-----:|-----:|----------:|---------------:|-----------------------------:|</span>
<span class="co">#&gt; | 2.084| 2.084|      2.084|             100|                           Inf|</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span></pre></body></html></div>
<p><img src="meta-analysis_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The results are practically the same and we cannot actually see any difference, and the AUC % overlap also indicates this.</p>
</div>
<div id="complex-data-structures" class="section level1">
<h1 class="hasAnchor">
<a href="#complex-data-structures" class="anchor"></a>Complex Data Structures</h1>
<p><code>concurve</code> can also handle complex data structures from <code>metafor</code> that are clustered.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="co">### copy data from Berkey et al. (1998) into 'dat'</span>
<span class="no">dat</span> <span class="kw">&lt;-</span> <span class="no">dat.berkey1998</span>

<span class="co">### construct list of the variance-covariance matrices of the observed outcomes for the studies</span>
<span class="no">V</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="no">dat</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"v1i"</span>, <span class="st">"v2i"</span>)], <span class="no">dat</span>$<span class="no">trial</span>), <span class="no">as.matrix</span>)

<span class="co">### construct block diagonal matrix</span>
<span class="no">V</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/bldiag.html">bldiag</a></span>(<span class="no">V</span>)

<span class="co">### fit multivariate model</span>
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/rma.mv.html">rma.mv</a></span>(<span class="no">yi</span>, <span class="no">V</span>, <span class="kw">mods</span> <span class="kw">=</span> ~ <span class="no">outcome</span> - <span class="fl">1</span>, <span class="kw">random</span> <span class="kw">=</span> ~ <span class="no">outcome</span> <span class="kw">|</span> <span class="no">trial</span>, <span class="kw">struct</span> <span class="kw">=</span> <span class="st">"UN"</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>)

<span class="co">### results based on sandwich method</span>
(<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/robust.html">robust</a></span>(<span class="no">res</span>, <span class="kw">cluster</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">trial</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of outcomes:   10</span>
<span class="co">#&gt; Number of clusters:   5</span>
<span class="co">#&gt; Outcomes per cluster: 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test of Moderators (coefficients 1:2):</span>
<span class="co">#&gt; F(df1 = 2, df2 = 3) = 41.6138, p-val = 0.0065</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Results:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            estimate      se     tval    pval    ci.lb    ci.ub </span>
<span class="co">#&gt; outcomeAL   -0.3392  0.1010  -3.3597  0.0437  -0.6605  -0.0179  * </span>
<span class="co">#&gt; outcomePD    0.3534  0.0675   5.2338  0.0136   0.1385   0.5683  * </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="no">l</span> <span class="kw">&lt;-</span> <span class="kw pkg">concurve</span><span class="kw ns">::</span><span class="fu"><a href="../reference/curve_meta.html">curve_meta</a></span>(<span class="no">res</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"uni"</span>, <span class="kw">robust</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">cluster</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">trial</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">steps</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">1L</span>)

<span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">l</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"c"</span>) +
  <span class="kw pkg">ggplot2</span><span class="kw ns">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>()</pre></body></html></div>
<p><img src="meta-analysis_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p>The interval function is quite narrow because there were so many iterations that were set by us.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">simstudy</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">parallel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nlme</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">metafor</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">concurve</span>)

<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="kw">varname</span> <span class="kw">=</span> <span class="st">"a.k"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">variance</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">id</span> <span class="kw">=</span> <span class="st">"study"</span>)
<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="no">defS</span>, <span class="kw">varname</span> <span class="kw">=</span> <span class="st">"d.0"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"nonrandom"</span>)
<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="no">defS</span>, <span class="kw">varname</span> <span class="kw">=</span> <span class="st">"v.k"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">variance</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">dist</span><span class="kw">=</span> <span class="st">"normal"</span>)
<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="no">defS</span>, <span class="kw">varname</span> <span class="kw">=</span> <span class="st">"s2.k"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">variance</span> <span class="kw">=</span> <span class="fl">.2</span>, <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"gamma"</span>)
<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="no">defS</span>, <span class="kw">varname</span> <span class="kw">=</span> <span class="st">"size.study"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="st">".3;.5;.2"</span>, <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"categorical"</span>)
<span class="no">defS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defData.html">defData</a></span>(<span class="no">defS</span>, <span class="kw">varname</span> <span class="kw">=</span> <span class="st">"n.study"</span>,
                <span class="kw">formula</span> <span class="kw">=</span> <span class="st">"(size.study==1) * 20 + (size.study==2) * 40 + (size.study==3) * 60"</span>,
                <span class="kw">dist</span> <span class="kw">=</span> <span class="st">"poisson"</span>)

<span class="no">defI</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/defDataAdd.html">defDataAdd</a></span>(<span class="kw">varname</span> <span class="kw">=</span> <span class="st">"y"</span>, <span class="kw">formula</span> <span class="kw">=</span> <span class="st">"a.k + x * (d.0 + v.k)"</span>, <span class="kw">variance</span> <span class="kw">=</span> <span class="st">"s2.k"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGkind</a></span>(<span class="kw">kind</span> <span class="kw">=</span> <span class="st">"L'Ecuyer-CMRG"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1031</span>)

<span class="no">ds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/genData.html">genData</a></span>(<span class="fl">12</span>, <span class="no">defS</span>)
<span class="no">ds</span>
<span class="co">#&gt;     study      a.k d.0        v.k      s2.k size.study n.study</span>
<span class="co">#&gt;  1:     1 4.745069   3 -5.1399796 16.275358          2      38</span>
<span class="co">#&gt;  2:     2 1.983020   3 -3.2693291 13.976232          3      66</span>
<span class="co">#&gt;  3:     3 1.865846   3  1.9742469  8.332148          2      40</span>
<span class="co">#&gt;  4:     4 4.235730   3 -3.2126873 11.100117          2      40</span>
<span class="co">#&gt;  5:     5 4.246219   3 -0.5858786 13.765175          3      57</span>
<span class="co">#&gt;  6:     6 3.899617   3  4.6808278  7.532707          2      41</span>
<span class="co">#&gt;  7:     7 3.059236   3 -5.9924638  7.817771          1      14</span>
<span class="co">#&gt;  8:     8 2.324586   3  5.7588246 10.970013          3      56</span>
<span class="co">#&gt;  9:     9 3.857260   3 -1.1081854 24.039016          3      75</span>
<span class="co">#&gt; 10:    10 4.308413   3 -1.9081253 14.084537          1      24</span>
<span class="co">#&gt; 11:    11 1.607899   3  0.2178001  8.271145          2      48</span>
<span class="co">#&gt; 12:    12 3.717728   3  1.8818612 11.274497          3      67</span>

<span class="no">dc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/genCluster.html">genCluster</a></span>(<span class="no">ds</span>, <span class="st">"study"</span>, <span class="st">"n.study"</span>, <span class="st">"id"</span>, )
<span class="no">dc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/trtAssign.html">trtAssign</a></span>(<span class="no">dc</span>, <span class="kw">strata</span> <span class="kw">=</span> <span class="st">"study"</span>, <span class="kw">grpName</span> <span class="kw">=</span> <span class="st">"x"</span>)
<span class="no">dc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simstudy/man/addColumns.html">addColumns</a></span>(<span class="no">defI</span>, <span class="no">dc</span>)


<span class="no">d.obs</span> <span class="kw">&lt;-</span> <span class="no">dc</span>[, <span class="fu">.</span>(<span class="no">study</span>, <span class="no">id</span>,<span class="no">s2.k</span>, <span class="no">x</span>, <span class="no">y</span>)]
<span class="no">d.obs</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">d.obs</span>)
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metafor/man/rma.mv.html">rma.mv</a></span>(<span class="kw">yi</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">V</span> <span class="kw">=</span> <span class="no">s2.k</span>, <span class="kw">W</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="kw">mods</span> <span class="kw">=</span> ~  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">study</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">x</span>),  <span class="kw">random</span> <span class="kw">=</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">x</span>) <span class="kw">|</span> <span class="no">study</span>, <span class="kw">struct</span><span class="kw">=</span><span class="st">"CS"</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">d.obs</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"REML"</span>)

<span class="no">a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curve_meta.html">curve_meta</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">res</span>, <span class="kw">measure</span> <span class="kw">=</span> <span class="st">"default"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"mv"</span>, <span class="kw">parm</span> <span class="kw">=</span> <span class="st">"factor(x)1"</span>, <span class="kw">cores</span> <span class="kw">=</span> <span class="fl">1L</span>)
<span class="fu"><a href="../reference/ggcurve.html">ggcurve</a></span>(<span class="no">a</span><span class="kw">[[</span><span class="fl">2</span>]], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"cdf"</span>)</pre></body></html></div>
<p><img src="meta-analysis_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>#&gt; R version 4.0.2 (2020-06-22)
#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)
#&gt; Running under: macOS Catalina 10.15.6
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
#&gt; 
#&gt; Random number generation:
#&gt;  RNG:     L'Ecuyer-CMRG 
#&gt;  Normal:  Inversion 
#&gt;  Sample:  Rejection 
#&gt;  
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; attached base packages:
#&gt; [1] parallel  stats     graphics  grDevices utils     datasets  methods  
#&gt; [8] base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] data.table_1.13.0 nlme_3.1-148      simstudy_0.1.16   ggplot2_3.3.2    
#&gt; [5] concurve_2.7.0    metafor_2.4-0     Matrix_1.2-18    
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] tidyr_1.1.1           splines_4.0.2         carData_3.0-4        
#&gt;  [4] ProfileLikelihood_1.1 assertthat_0.2.1      highr_0.8            
#&gt;  [7] cellranger_1.1.0      yaml_2.2.1            bcaboot_0.2-1        
#&gt; [10] gdtools_0.2.2         pillar_1.4.6          backports_1.1.8      
#&gt; [13] lattice_0.20-41       glue_1.4.1            uuid_0.1-4           
#&gt; [16] digest_0.6.25         ggsignif_0.6.0        colorspace_1.4-1     
#&gt; [19] htmltools_0.5.0       pkgconfig_2.0.3       broom_0.7.0          
#&gt; [22] haven_2.3.1           xtable_1.8-4          purrr_0.3.4          
#&gt; [25] scales_1.1.1          km.ci_0.5-2           openxlsx_4.1.5       
#&gt; [28] officer_0.3.12        rio_0.5.16            KMsurv_0.1-5         
#&gt; [31] tibble_3.0.3          farver_2.0.3          generics_0.0.2       
#&gt; [34] car_3.0-8             ellipsis_0.3.1        ggpubr_0.4.0         
#&gt; [37] withr_2.2.0           survival_3.2-3        magrittr_1.5         
#&gt; [40] crayon_1.3.4          readxl_1.3.1          memoise_1.1.0        
#&gt; [43] evaluate_0.14         fs_1.5.0              MASS_7.3-51.6        
#&gt; [46] rstatix_0.6.0         forcats_0.5.0         xml2_1.3.2           
#&gt; [49] foreign_0.8-80        tools_4.0.2           hms_0.5.3            
#&gt; [52] lifecycle_0.2.0       stringr_1.4.0         flextable_0.5.10     
#&gt; [55] munsell_0.5.0         zip_2.0.4             compiler_4.0.2       
#&gt; [58] pkgdown_1.5.1         survminer_0.4.8       pbmcapply_1.5.0      
#&gt; [61] systemfonts_0.2.3     rlang_0.4.7           grid_4.0.2           
#&gt; [64] rstudioapi_0.11       labeling_0.3          base64enc_0.1-3      
#&gt; [67] rmarkdown_2.3         boot_1.3-25           gtable_0.3.0         
#&gt; [70] abind_1.4-5           curl_4.3              R6_2.4.1             
#&gt; [73] zoo_1.8-8             gridExtra_2.3         knitr_1.29           
#&gt; [76] dplyr_1.0.1           survMisc_0.5.5        rprojroot_1.3-2      
#&gt; [79] desc_1.2.0            stringi_1.4.6         Rcpp_1.0.5           
#&gt; [82] vctrs_0.3.2           tidyselect_1.1.0      xfun_0.16</code></pre>
<hr>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<hr>
<div id="refs" class="references">
<div id="ref-Viechtbauer_2010">
<p>1. Viechtbauer W. <em>Conducting Meta-Analyses in R with the Metafor Package</em>.; 2010. <a href="https://www.jstatsoft.org/v36/i03/">https://www.jstatsoft.org/v36/i03/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://lesslikely.com/">Zad Rafi</a>, <a href="https://www.researchgate.net/profile/Andrew_Vigotsky">Andrew D. Vigotsky</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '328a30be91979e947c28ffd52f604eda',
    indexName: 'lesslikely-concurve',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
